name: "Statsig Publish SDK Action"
description: "Pushes releases from private to public SDK repositories"
author: "Statsig"

inputs:
  gh-token:
    description: "The Github Token"
    required: true

  npm-token:
    description: "The NPM Access Token"

  is-draft:
    description: "Draft Release?"
    default: false

runs:
  using: "composite"
  steps:
    - name: Say Hello
      run: echo Hello!
      shell: bash

    - name: Run Core
      uses: statsig-io/statsig-publish-sdk-action/core@main
      with:
        gh-token: ${{ inputs.gh-token }}
        npm-token: ${{ inputs.npm-token }}
        is-draft: ${{ inputs.is-draft }}

    - name: NPM Publish
      if: ${{ inputs.npm-token != '' }}
      uses: actions/setup-node@v3
      with:
        node-version: "16.x"
        registry-url: "https://registry.npmjs.org"
    - run: npm ci && npm publish
      if: ${{ inputs.npm-token != '' }}
      env:
        NODE_AUTH_TOKEN: ${{ secrets.NPM_TOKEN }}
